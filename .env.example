# Application Environment Variables

## Required for Production

### NEXT_PUBLIC_APP_URL
The base URL of your application (Railway production URL).

**Example (Railway):**
```
NEXT_PUBLIC_APP_URL=https://ee-admin-v5-production.up.railway.app
```

**Note:** This variable MUST be set in production to ensure auth redirects work correctly. The auth service at `https://auth.atap.solar` uses the `return_to` parameter to redirect users back to your app after authentication.

## Required for Database

### DATABASE_URL
PostgreSQL connection string for your Railway database.

**Example:**
```
DATABASE_URL=postgresql://postgres:password@host:5432/database
```

## Required for Auth

### JWT_SECRET
Secret key used to verify JWT tokens from the auth service.

**Example:**
```
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
```

**Important:** This should be a long, random string unique to your application.

## Optional

### BUBBLE_API_KEY
API key for Bubble.io data sync (if using sync features).

**Example:**
```
BUBBLE_API_KEY=b870d2b5ee6e6b39bcf99409c59c9e02
```

## Railway Deployment Setup

1. Go to your Railway project settings
2. Add these environment variables in the "Variables" tab:
   - `NEXT_PUBLIC_APP_URL` = Your Railway domain URL
   - `DATABASE_URL` = Your PostgreSQL connection string
   - `JWT_SECRET` = A secure random string
   - `BUBBLE_API_KEY` = (optional) Your Bubble API key

3. Redeploy your application after adding variables

## Troubleshooting Auth Redirects

If you're being redirected to `localhost:8080` after authentication:

1. **Check `NEXT_PUBLIC_APP_URL` is set** in Railway variables
2. **Verify it uses HTTPS** (not HTTP)
3. **Check Railway logs** to see what URL is being sent as `return_to`
4. **Contact auth service admin** if the issue persists (auth.atap.solar may have hardcoded redirects)

The auth service at `https://auth.atap.solar` should use the `return_to` parameter sent by your application. If it's still redirecting to localhost, the auth service configuration needs to be updated.
